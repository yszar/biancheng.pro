---
# è¿™æ˜¯æ–‡ç« çš„æ ‡é¢˜
title: Git Commitè§„èŒƒåŒ–æäº¤+è‡ªåŠ¨éªŒè¯+è‡ªåŠ¨ç”Ÿæˆ 
 changelog
# è¿™æ˜¯é¡µé¢çš„å›¾æ ‡
icon: page
# æ˜¯å¦åŸåˆ›
isOriginal: true
# æ˜¯å¦åŠ å…¥æ–‡ç« åˆ—è¡¨
article: true
# å±•å¼€æ·±åº¦
headerDepth: 2
# è¿™æ˜¯ä¾§è¾¹æ çš„é¡ºåº
# order: 1
# è®¾ç½®ä½œè€…
author: Jiu Yang
# è®¾ç½®å†™ä½œæ—¶é—´
date: 2022-11-04 02:10:02
# é¡µé¢å†…å®¹æè¿°
description: åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œå¤§å¤šæ•°å°ä¼™ä¼´å¯¹äº Commit message ä¿¡æ¯éƒ½æ˜¯ç®€å•å†™å†™ï¼Œæ²¡æœ‰å¾ˆå¥½çš„é‡è§†ï¼Œè¿™å¯¹äºé¡¹ç›®çš„ç®¡ç†å’Œç»´æŠ¤æ¥è¯´ï¼Œæ— ç–‘æ˜¯ä¸å‹å¥½çš„ã€‚æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯ç»“åˆæˆ‘è‡ªå·±çš„ä½¿ç”¨ç»éªŒæ¥å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ git commit çš„ä¸€äº›è§„èŒƒï¼Œè®©ä½ çš„ log ä¸ä»…â€œå¥½çœ‹â€è¿˜â€œå®ç”¨â€ã€‚
# ä¸€ä¸ªé¡µé¢å¯ä»¥æœ‰å¤šä¸ªåˆ†ç±»
category: [å·¥å…·è½¯ä»¶]
# ä¸€ä¸ªé¡µé¢å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾
tag: [git, è§„èŒƒåŒ–æäº¤]
# æ­¤é¡µé¢ä¼šåœ¨æ–‡ç« åˆ—è¡¨ç½®é¡¶
sticky: true
# æ­¤é¡µé¢ä¼šå‡ºç°åœ¨æ–‡ç« æ”¶è—ä¸­
star: true
# ä½ å¯ä»¥è‡ªå®šä¹‰é¡µè„š
# footer: è¿™æ˜¯æµ‹è¯•æ˜¾ç¤ºçš„é¡µè„š
# ä½ å¯ä»¥è‡ªå®šä¹‰ç‰ˆæƒä¿¡æ¯
# copyright: æ— ç‰ˆæƒ
# head:
#   - - meta
#     - name: keywords
#       content: 
#     - name: description
#       content: 
---

## ä¸ºä»€ä¹ˆè¦è§„èŒƒ commit message

è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªä¸å¤ªè§„èŒƒçš„ commit è®°å½•ï¼š

![](https://static.iamjy.com/blog-images/20221104022133.png-webp)

- ä¿®æ”¹äº†å“ªéƒ¨åˆ†æ–‡æœ¬ï¼ŸğŸ˜•
- è§£å†³äº†å“ªå‡ ä¸ªé—®é¢˜ï¼ŸğŸ˜•
- ä¿®å¤äº†å“ªä¸ª bugï¼ŸğŸ˜•
- åˆ›å»ºäº†å“ªä¸ªæ–‡ä»¶ï¼ŸğŸ˜•

è¿™ç§ commit ä¿¡æ¯å¯¹äºæƒ³è¦ä»ä¸­è·å–æœ‰æ•ˆä¿¡æ¯çš„äººæ¥è¯´æ— ç–‘æ˜¯ä¸€ç§è‡´å‘½çš„æ‰“å‡»ã€‚

æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªéå¸¸è§„èŒƒçš„ï¼Œä¹Ÿæ˜¯ç¤¾åŒºé‡Œé¢æ¯”è¾ƒæµè¡Œçš„ `Angularè§„èŒƒ` commit

å…¶å®æˆ‘å°±æ˜¯å» [Angular](https://github.com/angular) çš„ github æˆªçš„å›¾

![](https://static.iamjy.com/blog-images/20221104022610.png-webp)

æ˜¯ä¸æ˜¯ä¸€ç›®äº†ç„¶ï¼Ÿ

ä¸Šå›¾ä¸­è¿™ç§è§„èŒƒçš„ commit ä¿¡æ¯é¦–å…ˆæä¾›äº†æ›´å¤šçš„å†å²ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿæµè§ˆã€‚å…¶æ¬¡ï¼Œå¯ä»¥è¿‡æ»¤æŸäº› commitï¼ˆæ¯”å¦‚æ–‡æ¡£æ”¹åŠ¨ï¼‰ï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾ä¿¡æ¯ã€‚

## Angular å›¢é˜Ÿçš„ commit è§„èŒƒ

å¯¹äºÂ `git`Â æäº¤è§„èŒƒæ¥è¯´ï¼Œä¸åŒçš„å›¢é˜Ÿå¯èƒ½ä¼šæœ‰ä¸åŒçš„æ ‡å‡†ï¼Œæ¨èç›®å‰æ¯”è¾ƒæµè¡Œçš„Â [Angular å›¢é˜Ÿè§„èŒƒ]( https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular.js%2Fblob%2Fmaster%2FDEVELOPERS.md%23-git-commit-guidelines " https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines" ) å»¶ä¼¸å‡ºçš„[Conventional Commits specificationï¼ˆçº¦å®šå¼æäº¤ï¼‰]( https://link.juejin.cn/?target=https%3A%2F%2Fwww.conventionalcommits.org%2Fzh-hans%2Fv1.0.0%2F " https://www.conventionalcommits.org/zh-hans/v1.0.0/" )Â ã€‚

### çº¦å®šå¼æäº¤è§„èŒƒè¦æ±‚

è¦æ±‚å¦‚ä¸‹

```text
<type> [optional scope]: <description>

[optional body]

[optional footer(s)]
```

ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š

```text
<ç±»å‹> [å¯é€‰ èŒƒå›´]: <æè¿°>

[å¯é€‰ æ­£æ–‡]

[å¯é€‰ è„šæ³¨]
```

çœ‹ä¸ªè¯¦ç»†çš„æ —å­ï¼Œä¾æ—§æ˜¯åœ¨ Angual å›¢é˜Ÿçš„åœ°ç›˜æˆªçš„å›¾

![](https://static.iamjy.com/blog-images/20221104023631.png-webp)
  
Commit message çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderï¼ŒBody å’Œ Footerã€‚

### Header
`Header` éƒ¨åˆ†åªæœ‰ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼š`type`ï¼ˆå¿…éœ€ï¼‰ã€`scope`ï¼ˆå¯é€‰ï¼‰å’Œ `subject`ï¼ˆå¿…éœ€ï¼‰ã€‚

#### type

`type` : ç”¨äºè¯´æ˜ commit çš„ç±»å‹ã€‚ä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§:
- **feat**: æ–°å¢ feature
- **fix**: ä¿®å¤ bug
- **docs**: ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£ï¼Œå¦‚ readme. md
- **style**: ä»…ä»…æ˜¯å¯¹æ ¼å¼è¿›è¡Œä¿®æ”¹ï¼Œå¦‚é€—å·ã€ç¼©è¿›ã€ç©ºæ ¼ç­‰ã€‚ä¸æ”¹å˜ä»£ç é€»è¾‘ã€‚
- **refactor**: ä»£ç é‡æ„ï¼Œæ²¡æœ‰æ–°å¢åŠŸèƒ½æˆ–ä¿®å¤ bug
- **perf**: ä¼˜åŒ–ç›¸å…³ï¼Œå¦‚æå‡æ€§èƒ½ã€ç”¨æˆ·ä½“éªŒç­‰ã€‚
- **test**: æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€‚
- **chore**: æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰ã€‚
- **revert**: ç‰ˆæœ¬å›æ»š

#### scope

`scope` : ç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚: views, component, utils, test...

#### subject

`subject` : commit ç›®çš„çš„ç®€çŸ­æè¿°


###  Body

å¯¹æœ¬æ¬¡ commit ä¿®æ”¹å†…å®¹çš„å…·ä½“æè¿°, å¯ä»¥åˆ†ä¸ºå¤šè¡Œã€‚å¦‚ä¸‹å›¾:

```text
# body: 72-character wrapped. This should answer:
# * Why was this change necessary?
# * How does it address the problem?
# * Are there any side effects?
# initial commit
```

### Footer

ä¸€äº›å¤‡æ³¨, é€šå¸¸æ˜¯ `BREAKING CHANGE`(å½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸å…¼å®¹) æˆ–ä¿®å¤çš„ `bug`(å…³é—­ Issue) çš„é“¾æ¥ã€‚

æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œå¦‚æœæ¯æ¬¡ commit éƒ½è¿™ä¹ˆå†™ï¼Œç€å®æœ‰ç‚¹ç—›è‹¦ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥å°±è¯ç”Ÿäº† Commitizen è¿™æ ·çš„å·¥å…·ï¼Œåªéœ€è¦ä½¿ç”¨ `git cz` å‘½ä»¤ä»£æ›¿ `git commit` å°±å¯ä»¥å¸®æˆ‘ä»¬ä¹¦å†™ commit ä¿¡æ¯ï¼Œéå¸¸å¼ºå¤§ï¼

## è§„èŒƒåŒ–æäº¤

- å…ˆæ¥åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®

![](https://static.iamjy.com/blog-images/20221104025342.png-webp)

### commitizen

- ç„¶åå…¨å±€å®‰è£… `commitizen`

```bash
npm install -g commitizen
```

### cz-git

- å®‰è£… [cz-git](https://cz-git.qbb.sh/zh/)

> å¼•ç”¨å®˜ç½‘
> å·¥ç¨‹æ€§æ›´å¼ºï¼Œè½»é‡çº§ï¼Œé«˜åº¦è‡ªå®šä¹‰ï¼Œè¾“å‡ºæ ‡å‡†æ ¼å¼çš„ commitizen é€‚é…å™¨å’Œ CLI

- å…¨å±€ä½¿ç”¨

1. ä¸‹è½½å…¨å±€ä¾èµ–

```shell
npm install -g cz-git
```

2. å…¨å±€é…ç½®é€‚é…å™¨ç±»å‹

```shell
echo '{ "path": "cz-git" }' > ~/.czrc
```

- é¡¹ç›®ä¸­ä½¿ç”¨

1. ä¸‹è½½ä¾èµ–

```shell
npm install -D cz-git
```

### commitlint

- å®‰è£… `commitlint`

```shell
# Install commitlint cli and conventional config
npm install --save-dev @commitlint/{config-conventional,cli}
# For Windows:
npm install --save-dev @commitlint/config-conventional @commitlint/cli
```

- é…ç½®

ç›´æ¥è´´é…ç½®ï¼Œç…§æŠ„å°±è¡Œï¼Œå‘½åä¸º `.commitlintrc.js`ï¼Œæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•

æƒ³äº†è§£é…ç½®çš„å» [cz-git](https://cz-git.qbb.sh/zh/config/)  çœ‹

```js
// .commitlintrc.js
/** @type {import('cz-git').UserConfig} */
module.exports = {
  rules: {
    // @see: https://commitlint.js.org/#/reference-rules
  },
  extends: ['@commitlint/config-conventional'],
  prompt: {
    alias: { fd: 'docs: fix typos' },
    messages: {
      type: 'é€‰æ‹©ä½ è¦æäº¤çš„ç±»å‹ :',
      scope: 'é€‰æ‹©ä¸€ä¸ªæäº¤èŒƒå›´ï¼ˆå¯é€‰ï¼‰:',
      customScope: 'è¯·è¾“å…¥è‡ªå®šä¹‰çš„æäº¤èŒƒå›´ :',
      subject: 'å¡«å†™ç®€çŸ­ç²¾ç‚¼çš„å˜æ›´æè¿° :\n',
      body: 'å¡«å†™æ›´åŠ è¯¦ç»†çš„å˜æ›´æè¿°ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œ :\n',
      breaking: 'åˆ—ä¸¾éå…¼å®¹æ€§é‡å¤§çš„å˜æ›´ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œ :\n',
      footerPrefixsSelect: 'é€‰æ‹©å…³è”issueå‰ç¼€ï¼ˆå¯é€‰ï¼‰:',
      customFooterPrefixs: 'è¾“å…¥è‡ªå®šä¹‰issueå‰ç¼€ :',
      footer: 'åˆ—ä¸¾å…³è”issue (å¯é€‰) ä¾‹å¦‚: #31, #I3244 :\n',
      confirmCommit: 'æ˜¯å¦æäº¤æˆ–ä¿®æ”¹commit ?'
    },
    types: [
      { value: 'feat', name: 'feat:     âœ¨  æ–°å¢åŠŸèƒ½ | A new feature' },
      { value: 'fix', name: 'fix:      ğŸ›  ä¿®å¤ç¼ºé™· | A bug fix' },
      { value: 'docs', name: 'docs:     ğŸ“  æ–‡æ¡£æ›´æ–° | Documentation only changes' },
      { value: 'style', name: 'style:    ğŸ’„  ä»£ç æ ¼å¼ | Changes that do not affect the meaning of the code' },
      { value: 'refactor', name: 'refactor: â™»ï¸   ä»£ç é‡æ„ | A code change that neither fixes a bug nor adds a feature' },
      { value: 'perf', name: 'perf:     âš¡ï¸  æ€§èƒ½æå‡ | A code change that improves performance' },
      { value: 'test', name: 'test:     âœ…  æµ‹è¯•ç›¸å…³ | Adding missing tests or correcting existing tests' },
      { value: 'build', name: 'build:    ğŸ“¦ï¸   æ„å»ºç›¸å…³ | Changes that affect the build system or external dependencies' },
      { value: 'ci', name: 'ci:       ğŸ¡  æŒç»­é›†æˆ | Changes to our CI configuration files and scripts' },
      { value: 'revert', name: 'revert:   âªï¸  å›é€€ä»£ç  | Revert to a commit' },
      { value: 'chore', name: 'chore:    ğŸ”¨  å…¶ä»–ä¿®æ”¹ | Other changes that do not modify src or test files' },
    ],
    useEmoji: true,
    emojiAlign: 'center',
    themeColorCode: '',
    scopes: [],
    allowCustomScopes: true,
    allowEmptyScopes: true,
    customScopesAlign: 'bottom',
    customScopesAlias: 'custom',
    emptyScopesAlias: 'empty',
    upperCaseSubject: false,
    markBreakingChangeMode: false,
    allowBreakingChanges: ['feat', 'fix'],
    breaklineNumber: 100,
    breaklineChar: '|',
    skipQuestions: [],
    issuePrefixs: [
      // å¦‚æœä½¿ç”¨ gitee ä½œä¸ºå¼€å‘ç®¡ç†
      { value: 'link', name: 'link:     é“¾æ¥ ISSUES è¿›è¡Œä¸­' },
      { value: 'closed', name: 'closed:   æ ‡è®° ISSUES å·²å®Œæˆ' }
    ],
    customIssuePrefixsAlign: 'top',
    emptyIssuePrefixsAlias: 'skip',
    customIssuePrefixsAlias: 'custom',
    allowCustomIssuePrefixs: true,
    allowEmptyIssuePrefixs: true,
    confirmColorize: true,
    maxHeaderLength: Infinity,
    maxSubjectLength: Infinity,
    minSubjectLength: 0,
    scopeOverrides: undefined,
    defaultBody: '',
    defaultIssues: '',
    defaultScope: '',
    defaultSubject: ''
  }
}
```

### Husky

- å®‰è£… Husky ç”¨æ¥æ ¡éªŒæˆ‘ä»¬çš„æäº¤

```shell
# Install Husky v6
npm install husky --save-dev
# or
yarn add husky --dev

# Activate hooks
npx husky install
# or
yarn husky install
```

- æ·»åŠ  hook

```shell
npx husky add .husky/commit-msg  'npx --no -- commitlint --edit ${1}'
```

### æ•ˆæœ

è¿è¡Œ `git cz` çœ‹æ•ˆæœ

![](https://static.iamjy.com/blog-images/20221104031645.png-webp)

## è‡ªåŠ¨ç”Ÿæˆ changelog 

> [!warning] æ³¨æ„
> ç›®å‰æ”¾å¼ƒè¿™ç§æ–¹å¼ï¼Œæ”¹ç”¨  [release-it](#Release-it)


### standard -version

ç”¨åˆ°çš„å·¥å…· [standard-version](https://github.com/conventional-changelog/standard-version)

#### è¿™ä¸ªä¸œè¥¿å¯ä»¥åšä»€ä¹ˆ ?

- è‡ªåŠ¨å‡çº§ç‰ˆæœ¬
- è‡ªåŠ¨æ‰“ `tag`
- è‡ªåŠ¨ç”Ÿæˆ `changelog`

-  ç‰ˆæœ¬æ„æˆ
ç‰ˆæœ¬å·Â `major. minor. patch`

- é»˜è®¤çš„ç‰ˆæœ¬æ›´æ–°è§„åˆ™
`feature` ä¼šæ›´æ–° `minor`
`bug fix` ä¼šæ›´æ–° `patch`
`BREAKING CHANGES` ä¼šæ›´æ–° `major`

#### æ‰‹åŠ¨æ§åˆ¶ç‰ˆæœ¬æ›´æ–°

-  ç›´æ¥å‡çº§ `major`

`package.json`

```json
"scripts": {
"release-major": "standard-version --release-as major",
}
```

-  ç›´æ¥å‡çº§ `minor`

`package.json`

```json
"scripts": {
"release-minor": "standard-version --release-as minor",
}
```

-  ç›´æ¥å‡çº§ `patch`

`package. json`

```json
"scripts": {
"release-patch": "standard-version --release-as patch",
}
```

#### æŒ‰é»˜è®¤è§„åˆ™å‡çº§ç‰ˆæœ¬å·

`package. json`

```json
"scripts": {
"release": "standard-version",
}
```

#### å¼ºåˆ¶æ‰“ä¸€ä¸ªé™æ€ç‰ˆæœ¬å·

`package. json`

```json
"scripts": {
"release-static": "standard-version --release-as 3.3.3",
}
```

#### ç¬¬ä¸€ä¸ªç‰ˆæœ¬ (è¯¥æ–¹å¼ä¸ä¼šå‡çº§ç‰ˆæœ¬å·)


```shell
# npm run script
npm run release -- --first-release
# global bin
standard-version --first-release
# npx
npx standard-version --first-release
```

#### é…ç½®å“ªäº› commit æ¶ˆæ¯å†™å…¥ changelog

`hidden` å±æ€§å€¼æ§åˆ¶æ˜¯å¦å°†è¯¥ç±»å‹çš„ commit æ¶ˆæ¯å†™å…¥ `changlog`, ä¸å¡«çš„æƒ…å†µä¸‹é»˜è®¤æ˜¯:`false`

#### é…ç½®æ–‡ä»¶

> å‘½åä¸º `.versionrc.js` æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œç¾åŒ–ä½ çš„ changelog

```js
module.exports = {
    "types": [
      { "type": "feat", "section": "âœ¨ Features | æ–°åŠŸèƒ½" },
      { "type": "fix", "section": "ğŸ› Bug Fixes | Bug ä¿®å¤" },
      { "type": "init", "section": "ğŸ‰ Init | åˆå§‹åŒ–" },
      { "type": "docs", "section": "âœï¸ Documentation | æ–‡æ¡£" },
      { "type": "style", "section": "ğŸ’„ Styles | é£æ ¼" },
      { "type": "refactor", "section": "â™»ï¸ Code Refactoring | ä»£ç é‡æ„" },
      { "type": "perf", "section": "âš¡ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
      { "type": "test", "section": "âœ… Tests | æµ‹è¯•" },
      { "type": "revert", "section": "âª Revert | å›é€€" },
      { "type": "build", "section": "ğŸ“¦â€ Build System | æ‰“åŒ…æ„å»º" },
      { "type": "chore", "section": "ğŸš€ Chore | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·" },
      { "type": "ci", "section": "ğŸ‘· Continuous Integration | CI é…ç½®" }
    ]
  }
```

è´´ä¸Šæˆ‘æœ€ç»ˆçš„ `package.json` çš„ `scripts` éƒ¨åˆ†

```json
  "scripts": {
    "commit": "git cz",
    "release": "standard-version",
    "release-beta": "standard-version -p release --skip.changelog false --skip.tag false",
    "changelog": "conventional-changelog -p angular -i CHANGELOG.md -s -r 0 && git add CHANGELOG.md",
    "release:major": "standard-version -r major -n",
    "release:minor": "standard-version -r minor -n",
    "release:patch": "standard-version -r patch -n"
  },
```

### Release-it 

å…ˆç®€å•è®°å½•ä¸€ä¸‹è¿‡ç¨‹

### å®‰è£…

- æœ¬ä½“
```shell
npm i -D release-it
```

- æ’ä»¶
```
npm i -D @release-it/conventional-changelog
```

